{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block title %}
{% trans 'Search book to add' %} | BooxMix
{% endblock %}

{% block content %}

<div class="container">
    <section id="search-book">
        <h2 class="mt-4 mt-md-5">
            {% if request.GET.q %}
            {% blocktrans %}Books related with "{{ query }}"{% endblocktrans %}
            {% else %}
            {% blocktrans %}Search book to add{% endblocktrans %}
            {% endif %}
        </h2>
        <form action="" method="post">{% csrf_token %}
            <div class="row mt-4">
                <div class="col-sm-9 col-lg-10">
                    {{ form.q }}
                    {{ form.q.errors }}
                </div>
                <div class="col-sm-3 col-lg-2 d-none d-sm-block">
                    <input type="submit" class="btn btn-outline-sub btn-fit" value="{% trans 'Search' %}">
                </div>
            </div>
        </form>
        <div>
            <div>
                <a
                    class="btn btn-inline-sub mt-3 text-sm"
                    {% if mode == 'create' %}
                    href="{% url 'main:playlist_create' %}?continue=True"
                    {% elif mode == 'update' %}
                    href="{% url 'main:playlist_update' view.kwargs.category view.kwargs.pk %}?continue=True"
                    {% endif %}
                >
                    <i class="fas fa-angle-left"></i> {% trans 'Back' %}
                </a>
            </div>
        </div>
    </section>

    <section id="book-list">
        <div class="row mt-4">
            {% for book in books %}
            <div class="book-item col-sm-3 col-lg-2">
                <div class="line-gray my-4"></div>
                <div class="row">
                    <div class="col-4 col-sm-12">
                        <img class="w-100" src="{{ book.cover }}">
                    </div>
                    <div class="col-8 col-sm-12">
                        <h5 class="mt-sm-2 font-bold">{{ book.title }}</h5>
                        <h6 class="mt-1">{{ book.author }}</h6>
                        <div>
                            <button
                                class="btn btn-outline-main btn-fit w-100 mt-2"
                                {% if mode == 'create' %}
                                onclick="location.href='{% url 'main:playlist_create_book_store' book.pk %}'"
                                {% elif mode == 'update' %}
                                onclick="location.href='{% url 'main:playlist_update_book_store' view.kwargs.category view.kwargs.pk book.pk %}'"
                                {% endif %}
                                {% if book.pk|stringformat:'s' in books_in_session %}
                                disabled
                                {% endif %}
                            >
                                {% trans 'Add' %}
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            {% empty %}
            {% if request.GET.q %}
            <div class="col-12">
                <h4>{% trans 'No book found. Please search by other words.' %}</h4>
            </div>
            {% endif %}
            {% endfor %}
        </div>
    </section>
</div>

{% endblock %}
